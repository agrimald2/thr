import{y as g,s as m,o as i,e as u,a as t,t as c,l as n,p as l,b as f,f as p,c as x}from"./app-13GDqpOi.js";import b from"./Error-CoTEiaXB.js";import w from"./Loader-C76BLEwH.js";import{_}from"./_plugin-vue_export-helper-DlAUqK2U.js";const D={props:["loginKey","publicKey","apiKey","accountId","signature","payment"],components:{ErrorModal:b,Loader:w},data(){return{loader:!1,haveError:!1,errorText:"",cardData:{cardholder:"",cardNumber:"",expired:{month:"",year:""},securityCode:"",email:""},amount:this.payment.amount,currency:this.payment.currency,description:this.payment.description,payu:{endpoint:"https://api.payulatam.com",endpoint_payment:"/payments-api/4.0/service.cgi",deviceSessionId:"",sandbox_mode:!0,loginKey:this.loginKey,publicKey:this.publicKey,apiKey:this.apiKey,hashSignature:this.signature}}},mounted(){console.log(this.payu),console.log("All good")},computed:{isValid(){return!(this.cardData.cardholder.length<5||this.cardData.cardNumber.replace(/\s/g,"").length<=12||this.cardData.expired.month===""||this.cardData.expired.year===""||this.cardData.securityCode.length<3)}},methods:{format(){this.cardData.cardNumber=this.cardData.cardNumber.replace(/\W/gi,"").replace(/(.{4})/g,"$1 ").trim()},noSpaces(){return this.cardData.cardNumber.replace(/\s/g,"")},onSubmit(){this.pay()},async pay(){this.loader=!0;let s=this.noSpaces();try{const e=await g.post(this.payu.endpoint+this.payu.endpoint_payment,{language:"es",command:"SUBMIT_TRANSACTION",merchant:{apiKey:this.apiKey,apiLogin:this.loginKey},transaction:{order:{accountId:this.accountId,referenceCode:this.payment.reference_code,description:this.payment.description,language:"es",signature:this.signature,additionalValues:{TX_VALUE:{value:this.payment.amount,currency:this.payment.currency}},buyer:{fullName:"First name and second buyer name",emailAddress:"buyer_test@test.com",contactPhone:"7563126",dniNumber:"123456789"}},creditCard:{number:s,securityCode:this.cardData.securityCode,expirationDate:this.cardData.expired.year+"/"+this.cardData.expired.month,name:this.cardData.cardholder},type:"AUTHORIZATION_AND_CAPTURE",paymentMethod:"VISA",paymentCountry:"PE",ipAddress:"127.0.0.1",userAgent:"Mozilla/5.0 (Windows NT 5.1; rv:18.0) Gecko/20100101 Firefox/18.0"},test:!0});console.log(e),this.loader=!1}catch(e){this.loader=!1,this.showError(e.data.error),console.log(e)}},showError(s){this.haveError=!0,this.errorText=s},handleCloseModal(){this.haveError=!1}}},v={class:"flex items-center justify-center min-h-screen bg-gray-100"},C={class:"p-6 text-center bg-white shadow-lg rounded-lg"},N={class:"max-w-md mx-auto shadow-lg rounded-xl bg-white p-6"},k={class:"text-2xl font-semibold text-gray-800"},V={class:"uppercase"},E={class:"text-gray-600 text-sm"},K={class:"credit-card w-full sm:w-auto shadow-lg mx-auto rounded-xl bg-white"},T={class:"mt-4 p-4"},A={class:"my-3"},M={class:"my-3"},S={class:"my-3 flex flex-col"},U={class:"grid grid-cols-2 sm:grid-cols-4 gap-2"},I={class:"mt-3"},B={class:"mt-2 p-4"},L={key:0,class:"flex justify-center center mb-2"},P=["disabled"];function R(s,e,d,Y,a,o){const h=m("Loader"),y=m("ErrorModal");return i(),u("div",v,[t("div",C,[t("div",N,[t("div",k,[t("span",null,c(d.payment.amount),1),t("span",V,c(d.payment.currency),1)]),t("p",E,c(d.payment.reference_code)+" | "+c(d.payment.description),1)]),t("div",K,[t("main",T,[t("div",A,[n(t("input",{type:"text",class:"block w-full px-5 py-2 border rounded-lg bg-white shadow-lg placeholder-gray-400 text-gray-700 focus:ring focus:outline-none",placeholder:"Card holder",maxlength:"22","onUpdate:modelValue":e[0]||(e[0]=r=>a.cardData.cardholder=r)},null,512),[[l,a.cardData.cardholder]])]),t("div",M,[n(t("input",{type:"text",class:"block w-full px-5 py-2 border rounded-lg bg-white shadow-lg placeholder-gray-400 text-gray-700 focus:ring focus:outline-none",placeholder:"Card number","onUpdate:modelValue":e[1]||(e[1]=r=>a.cardData.cardNumber=r),onKeydown:e[2]||(e[2]=(...r)=>o.format&&o.format(...r)),onKeyup:e[3]||(e[3]=(...r)=>o.format&&o.format(...r)),maxlength:"19"},null,544),[[l,a.cardData.cardNumber]])]),t("div",S,[t("div",U,[n(t("input",{type:"text",class:"block w-full px-5 py-2 border rounded-lg bg-white shadow-lg placeholder-gray-400 text-gray-700 focus:ring focus:outline-none",placeholder:"MM",maxlength:"2","onUpdate:modelValue":e[4]||(e[4]=r=>a.cardData.expired.month=r)},null,512),[[l,a.cardData.expired.month]]),n(t("input",{type:"text",class:"block w-full px-5 py-2 border rounded-lg bg-white shadow-lg placeholder-gray-400 text-gray-700 focus:ring focus:outline-none",placeholder:"YYYY",maxlength:"4","onUpdate:modelValue":e[5]||(e[5]=r=>a.cardData.expired.year=r)},null,512),[[l,a.cardData.expired.year]]),n(t("input",{type:"text",class:"block w-full col-span-2 px-5 py-2 border rounded-lg bg-white shadow-lg placeholder-gray-400 text-gray-700 focus:ring focus:outline-none",placeholder:"CCV",maxlength:"4","onUpdate:modelValue":e[6]||(e[6]=r=>a.cardData.securityCode=r),onFocus:e[7]||(e[7]=r=>s.card="back"),onBlur:e[8]||(e[8]=r=>s.card="front")},null,544),[[l,a.cardData.securityCode]])]),t("div",I,[n(t("input",{type:"email",class:"block w-full px-5 py-2 border rounded-lg bg-white shadow-lg placeholder-gray-400 text-gray-700 focus:ring focus:outline-none",placeholder:"Email",maxlength:"45","onUpdate:modelValue":e[9]||(e[9]=r=>a.cardData.email=r)},null,512),[[l,a.cardData.email]])])])]),t("footer",B,[a.loader?(i(),u("div",L,[f(h)])):p("",!0),a.loader?p("",!0):(i(),u("button",{key:1,class:"mt-2 submit-button px-4 py-3 rounded-full bg-blue-300 text-blue-900 focus:ring focus:outline-none w-full text-xl font-semibold transition-colors",disabled:!o.isValid,onClick:e[10]||(e[10]=(...r)=>o.onSubmit&&o.onSubmit(...r))}," Pay now ",8,P))])])]),a.haveError?(i(),x(y,{key:0,errorText:a.errorText,onClose:o.handleCloseModal},null,8,["errorText","onClose"])):p("",!0)])}const z=_(D,[["render",R],["__scopeId","data-v-87370d31"]]);export{z as default};

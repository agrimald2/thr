import{y as b,s as f,o as i,e as l,a as e,t as c,l as d,A as g,f as p,p as u,q as v,b as w,c as D,x as m,B as k,C}from"./app-YD_aIGBF.js";import S from"./Error-CvwwjFbQ.js";import N from"./Loader-D8kucu2B.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";const T={props:["merchantId","publicKey","payment","isProduction","endpoint"],components:{ErrorModal:S,Loader:N},data(){return{loader:!1,haveError:!1,errorText:"",cardData:{cardholder:"",cardNumber:"",expired:{month:"",year:""},securityCode:"",email:""},amount:this.payment.amount,currency:this.payment.currency,description:this.payment.description,card:"front",openpay:{token:"",endpoint_sandbox_openpay:this.endpoint,endpoint_payment:"/api/pay/openpay",deviceSessionId:"",openpay_sandbox_mode:!this.isProduction,openpay_id:this.merchantId,openpay_key:this.publicKey}}},mounted(){console.log(this.openpay),OpenPay.setId(this.openpay.openpay_id),OpenPay.setApiKey(this.openpay.openpay_key),OpenPay.setSandboxMode(this.openpay.openpay_sandbox_mode),this.openpay.deviceSessionId=OpenPay.deviceData.setup(),console.log("All good")},computed:{isValid(){return!(this.cardData.cardholder.length<5||this.cardData.cardNumber.replace(/\s/g,"").length<=12||this.cardData.expired.month===""||this.cardData.expired.year===""||this.cardData.securityCode.length<3)}},methods:{format(){this.cardData.cardNumber=this.cardData.cardNumber.replace(/\W/gi,"").replace(/(.{4})/g,"$1 ").trim()},noSpaces(){return this.cardData.cardNumber.replace(/\s/g,"")},onSubmit(){this.pay()},async pay(){this.loader=!0;let r=this.noSpaces();try{const t=await new Promise((s,y)=>{OpenPay.token.create({holder_name:this.cardData.cardholder,card_number:r,cvv2:this.cardData.securityCode,expiration_month:this.cardData.expired.month,expiration_year:this.cardData.expired.year},s,y)});if(this.openpay.token=t.data.id,this.openpay.token){console.log(this.openpay.token,"Token obtenido:");const s=await b.post(this.openpay.endpoint_payment,{amount:this.amount,currency:this.currency,description:this.description,deviceSessionId:this.openpay.deviceSessionId,email:this.cardData.email,last_name:this.cardData.cardholder,name:this.cardData.cardholder,token:this.openpay.token,account_id:this.payment.account_id,payment_id:this.payment.id});this.loader=!1,console.log(s),s.data.error?this.showError(s.data.error.description):window.location.reload()}}catch(t){this.loader=!1,this.showError(t.data.description),console.log(t)}},showError(r){this.haveError=!0,this.errorText=r},handleCloseModal(){this.haveError=!1}}},h=r=>(k("data-v-818accfa"),r=r(),C(),r),V={class:"flex items-center justify-center min-h-screen bg-gray-100"},I={class:"p-6 text-center bg-white shadow-lg rounded-lg"},M={class:"max-w-md mx-auto shadow-lg rounded-xl bg-white p-6"},P={class:"text-2xl font-semibold text-gray-800"},j={class:"uppercase"},O={class:"text-gray-600 text-sm"},Y={class:"credit-card w-full sm:w-auto shadow-lg mx-auto rounded-xl bg-white"},B={class:"flex flex-col justify-center items-center"},U={class:"relative"},K=h(()=>e("img",{class:"w-full h-auto",src:"https://www.computop-paygate.com/Templates/imagesaboutYou_desktop/images/svg-cards/card-visa-front.png",alt:"front credit card"},null,-1)),A={class:"front bg-transparent text-lg w-full text-white px-12 absolute left-0 bottom-12"},L={class:"number mb-5 sm:text-xl"},R={class:"flex flex-row justify-between"},q={class:""},F={key:0},W={class:"relative"},z=h(()=>e("img",{class:"w-full h-auto",src:"https://www.computop-paygate.com/Templates/imagesaboutYou_desktop/images/svg-cards/card-visa-back.png",alt:"back credit card"},null,-1)),G={class:"bg-transparent text-white text-xl w-full flex justify-end absolute bottom-20 px-8 sm:bottom-24 right-0 sm:px-12"},H={class:"border border-white w-16 h-9 flex justify-center items-center"},J=m('<ul class="flex" data-v-818accfa><li class="mx-2" data-v-818accfa><img class="w-16" src="https://www.computop-paygate.com/Templates/imagesaboutYou_desktop/images/computop.png" alt="" data-v-818accfa></li><li class="mx-2" data-v-818accfa><img class="w-14" src="https://www.computop-paygate.com/Templates/imagesaboutYou_desktop/images/verified-by-visa.png" alt="" data-v-818accfa></li><li class="ml-5" data-v-818accfa><img class="w-7" src="https://www.computop-paygate.com/Templates/imagesaboutYou_desktop/images/mastercard-id-check.png" alt="" data-v-818accfa></li></ul>',1),Q={class:"mt-4 p-4"},X={class:"my-3"},Z={class:"my-3"},$={class:"my-3 flex flex-col"},ee={class:"grid grid-cols-2 sm:grid-cols-4 gap-2"},ae=m('<option value="" selected disabled data-v-818accfa>MM</option><option value="01" data-v-818accfa>01</option><option value="02" data-v-818accfa>02</option><option value="03" data-v-818accfa>03</option><option value="04" data-v-818accfa>04</option><option value="05" data-v-818accfa>05</option><option value="06" data-v-818accfa>06</option><option value="07" data-v-818accfa>07</option><option value="08" data-v-818accfa>08</option><option value="09" data-v-818accfa>09</option><option value="10" data-v-818accfa>10</option><option value="11" data-v-818accfa>11</option><option value="12" data-v-818accfa>12</option>',13),te=[ae],oe=m('<option value="" selected disabled data-v-818accfa>YY</option><option value="24" data-v-818accfa>2024</option><option value="25" data-v-818accfa>2025</option><option value="26" data-v-818accfa>2026</option><option value="27" data-v-818accfa>2027</option><option value="28" data-v-818accfa>2028</option><option value="29" data-v-818accfa>2029</option>',7),se=[oe],re={class:"mt-3"},ne={class:"mt-2 p-4"},ce={key:0,class:"flex justify-center center mb-2"},de=["disabled"],ie=h(()=>e("div",{class:"mt-2 flex justify-center"},[e("img",{src:"https://www.ecommercenews.pe/wp-content/uploads/2021/10/Openpay-1.jpg",alt:"",style:{width:"30%"}})],-1));function le(r,t,s,y,a,n){const _=f("Loader"),x=f("ErrorModal");return i(),l("div",V,[e("div",I,[e("div",M,[e("div",P,[e("span",null,c(s.payment.amount),1),e("span",j,c(s.payment.currency),1)]),e("p",O,c(s.payment.description),1)]),e("div",Y,[e("header",B,[d(e("div",U,[K,e("div",A,[e("p",L,c(a.cardData.cardNumber!==""?a.cardData.cardNumber:"0000-0000-0000-0000"),1),e("div",R,[e("p",null,c(a.cardData.cardholder!==""?a.cardData.cardholder:"Card holder"),1),e("div",q,[e("span",null,c(a.cardData.expired.month),1),a.cardData.expired.month!==""?(i(),l("span",F,"/")):p("",!0),e("span",null,c(a.cardData.expired.year),1)])])])],512),[[g,a.card==="front"]]),d(e("div",W,[z,e("div",G,[e("div",H,[e("p",null,c(a.cardData.securityCode!==""?a.cardData.securityCode:"code"),1)])])],512),[[g,a.card==="back"]]),J]),e("main",Q,[e("div",X,[d(e("input",{type:"text",class:"block w-full px-5 py-2 border rounded-lg bg-white shadow-lg placeholder-gray-400 text-gray-700 focus:ring focus:outline-none",placeholder:"Card holder",maxlength:"22","onUpdate:modelValue":t[0]||(t[0]=o=>a.cardData.cardholder=o)},null,512),[[u,a.cardData.cardholder]])]),e("div",Z,[d(e("input",{type:"text",class:"block w-full px-5 py-2 border rounded-lg bg-white shadow-lg placeholder-gray-400 text-gray-700 focus:ring focus:outline-none",placeholder:"Card number","onUpdate:modelValue":t[1]||(t[1]=o=>a.cardData.cardNumber=o),onKeydown:t[2]||(t[2]=(...o)=>n.format&&n.format(...o)),onKeyup:t[3]||(t[3]=(...o)=>n.format&&n.format(...o)),maxlength:"19"},null,544),[[u,a.cardData.cardNumber]])]),e("div",$,[e("div",ee,[d(e("select",{class:"form-select appearance-none block w-full px-5 py-2 border rounded-lg bg-white shadow-lg placeholder-gray-400 text-gray-700 focus:ring focus:outline-none","onUpdate:modelValue":t[4]||(t[4]=o=>a.cardData.expired.month=o)},te,512),[[v,a.cardData.expired.month]]),d(e("select",{class:"form-select appearance-none block w-full px-5 py-2 border rounded-lg bg-white shadow-lg placeholder-gray-400 text-gray-700 focus:ring focus:outline-none","onUpdate:modelValue":t[5]||(t[5]=o=>a.cardData.expired.year=o)},se,512),[[v,a.cardData.expired.year]]),d(e("input",{type:"text",class:"block w-full col-span-2 px-5 py-2 border rounded-lg bg-white shadow-lg placeholder-gray-400 text-gray-700 focus:ring focus:outline-none",placeholder:"Security code",maxlength:"4","onUpdate:modelValue":t[6]||(t[6]=o=>a.cardData.securityCode=o),onFocus:t[7]||(t[7]=o=>a.card="back"),onBlur:t[8]||(t[8]=o=>a.card="front")},null,544),[[u,a.cardData.securityCode]])]),e("div",re,[d(e("input",{type:"email",class:"block w-full px-5 py-2 border rounded-lg bg-white shadow-lg placeholder-gray-400 text-gray-700 focus:ring focus:outline-none",placeholder:"Email",maxlength:"45","onUpdate:modelValue":t[9]||(t[9]=o=>a.cardData.email=o)},null,512),[[u,a.cardData.email]])])])]),e("footer",ne,[a.loader?(i(),l("div",ce,[w(_)])):p("",!0),a.loader?p("",!0):(i(),l("button",{key:1,class:"mt-2 submit-button px-4 py-3 rounded-full bg-blue-300 text-blue-900 focus:ring focus:outline-none w-full text-xl font-semibold transition-colors",disabled:!n.isValid,onClick:t[10]||(t[10]=(...o)=>n.onSubmit&&n.onSubmit(...o))}," Pay now ",8,de))]),ie])]),a.haveError?(i(),D(x,{key:0,errorText:a.errorText,onClose:n.handleCloseModal},null,8,["errorText","onClose"])):p("",!0)])}const ye=E(T,[["render",le],["__scopeId","data-v-818accfa"]]);export{ye as default};
